<!doctype html>
<html>
<head>
  <title>Basic tests</title>
  <link rel="import" href="../node_modules/mocha-test/mocha-test.html">
  <style>
    iframe { display: none; }
  </style>
</head>
<body>
  <iframe id="basicsFrame" src="./basics/index.html"></iframe>
  <mocha-test>
    <template>
      <script>
        describe('Basics', function(){
          const win = basicsFrame.contentWindow;
          const doc = basicsFrame.contentDocument;
          const docEl = doc.documentElement;

          before(function(done) {
            setTimeout(done, 100);
          });

          it('Renders the initial page', function(){
            let el = doc.querySelector('basic-app');
            let div = el.shadowRoot.querySelector('#root');
            assert.equal(div.textContent, 'Hello world!');
          });

          it('componentDidMount was called', function(){
            let el = doc.querySelector('#result');
            assert.equal(el.textContent, 'loaded');
          });

          it('Renders subelements using the constructor', function(){
            let el = doc.querySelector('basic-app');
            let nested = el.shadowRoot.querySelector('another-el');
            assert.ok(nested, 'The nested element was rendered');

            let inner = nested.shadowRoot.firstChild;
            assert.equal(inner.textContent, 'Another el');
          });

          it('Renders hyperscript that uses numbers', function(){
            let el = doc.querySelector('basic-app');
            let mathel = el.shadowRoot.querySelector('math-el');
            let inner = mathel.shadowRoot.firstChild;
            assert.equal(inner.textContent, '15 of 15');
          });
        });
      </script>
    </template>
  </mocha-test>
</body>
</html>
